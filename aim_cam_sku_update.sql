MERGE `{cam_table_id}` T
USING `{staging_table_id}` S
ON 
    -- Vehicle Match
    UPPER(TRIM(CONCAT(IFNULL(T.Make,''), ' ', IFNULL(T.Model,'')))) = UPPER(TRIM(S.Vehicle))
    AND
    -- Size Match
    UPPER(TRIM(CONCAT(IFNULL(T.Width,''), '/', IFNULL(T.Profile,''), ' R', IFNULL(T.Rim,'')))) = UPPER(TRIM(S.Size))
    
WHEN MATCHED THEN
    UPDATE SET
    SKU1=COALESCE(S.SKU1, T.SKU1), SKU2=COALESCE(S.SKU2, T.SKU2), SKU3=COALESCE(S.SKU3, T.SKU3),
    SKU4=COALESCE(S.SKU4, T.SKU4), SKU5=COALESCE(S.SKU5, T.SKU5), SKU6=COALESCE(S.SKU6, T.SKU6),
    SKU7=COALESCE(S.SKU7, T.SKU7), SKU8=COALESCE(S.SKU8, T.SKU8), SKU9=COALESCE(S.SKU9, T.SKU9),
    SKU10=COALESCE(S.SKU10, T.SKU10), SKU11=COALESCE(S.SKU11, T.SKU11), SKU12=COALESCE(S.SKU12, T.SKU12),
    SKU13=COALESCE(S.SKU13, T.SKU13), SKU14=COALESCE(S.SKU14, T.SKU14), SKU15=COALESCE(S.SKU15, T.SKU15),
    SKU16=COALESCE(S.SKU16, T.SKU16), SKU17=COALESCE(S.SKU17, T.SKU17), SKU18=COALESCE(S.SKU18, T.SKU18),
    SKU19=COALESCE(S.SKU19, T.SKU19), SKU20=COALESCE(S.SKU20, T.SKU20), SKU21=COALESCE(S.SKU21, T.SKU21),
    SKU22=COALESCE(S.SKU22, T.SKU22), SKU23=COALESCE(S.SKU23, T.SKU23), SKU24=COALESCE(S.SKU24, T.SKU24),
    last_modified=S.last_modified
    
WHEN NOT MATCHED THEN
    INSERT (Make, Model, Width, Profile, Rim, 
            SKU1, SKU2, SKU3, SKU4, SKU5, SKU6, SKU7, SKU8, SKU9, SKU10, SKU11, SKU12,
            SKU13, SKU14, SKU15, SKU16, SKU17, SKU18, SKU19, SKU20, SKU21, SKU22, SKU23, SKU24,
            last_modified)
    VALUES (S.Make, S.Model, S.Width, S.Profile, S.Rim,
            S.SKU1, S.SKU2, S.SKU3, S.SKU4, S.SKU5, S.SKU6, S.SKU7, S.SKU8, S.SKU9, S.SKU10, S.SKU11, S.SKU12,
            S.SKU13, S.SKU14, S.SKU15, S.SKU16, S.SKU17, S.SKU18, S.SKU19, S.SKU20, S.SKU21, S.SKU22, S.SKU23, S.SKU24,
            S.last_modified)
